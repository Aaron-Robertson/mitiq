
## About mitiq's code tree

Below you can find information on the contents of the folder containing the script that generates `mitiq`'s code tree, which is generated from `mitiq/docs/mitiq_tree_plot` with
`python mitiq-structure.py`.


### Contents

The folder `mitiq/docs/mitiq_tree_plot` contains the files required to generate the code tree.
The code is adapted from `qutip/qutip-doc` repository.
#### The Python script

* `mitiq-structure.py` contains the script that generates the code tree.
It crawls the `mitiq/mitiq` directory finding function and classes in the `.py`
files. The script generates a database file in `d3_data/mitiq.json`.

By running `python mitiq-structure.py` from bash, the `mitiq.json` file will be
updated, and the number of modules included in it will be printed to terminal.

The code graph is created by first collecting the repository structure of `mitiq/mitiq`.
This is done essentially by parsing the directory and sub-directories with the
`os.walk()` method.

Some of the properties of this file that can be customized accordingly:

* `exclude_patterns` contains patterns in filenames that will not be included in the code tree.

* `mitiq_root` specifies where the `mitiq` folder is found.

* `colors` contains a list of colors in HEX format.

* `module_cmap` contains a list of modules and numbers, which correspond to
colors used in the code tree.

* the `hidden_modules` list contains all sub-directories that should be parsed.

#### The generated html file

* The file `mitiq_org.html` can be opened with FireFox to visualize the tree.
It may not render properly in other browsers.

* The folder `d3_data` contains the `.json` file; some JavaScript and CSS files
that control the properties of the graphics layout used by `mitiq_org.html`.

In particular:

* `mitiq.json` is the database generated by the python script and containing all
the information on the code graph structure.

* `tree.css` contains some CSS information that allow to control the `font`,
the text size, and the graphics properties of the circles representing each node.

* `tree-radial.js` builds the circular code tree.

* `d3.layout.min.js` and `d3.min.js` contain some JavaScript specifics.

### Generating the code tree

These are instructions to generate an html and pdf version of
mitiq code tree.


For each `mitiq` release, generate a new code tree to include it in the
documentation.

#### 0. Add modules to the script

In the `mitiq-structure.py` file, add to the `cmap` list the new modules (and
remove the deleted ones).

#### 1. Run the Python script

Run from bash `python mitiq-structure.py`.

#### 2. Check the html and generate the pdf

In order to open `mitiq_tree.html`, you need to set up a local server.
Run from the terminal:
`python3 -m http.server` and open your browser. Go to `http://localhost:8000/` and from there navigate to the `mitiq_tree.html` file and open it.
The tree should be rendered. Save the graphics by printing it to a pdf file
as `Mitiq_Code_Tree.pdf`.

